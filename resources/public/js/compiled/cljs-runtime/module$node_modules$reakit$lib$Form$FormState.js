shadow$provide.module$node_modules$reakit$lib$Form$FormState=function(global,require,module,exports){function filterAllEmpty(object){if(Array.isArray(object))return object.filter(function(value){return isPlainObject.isPlainObject(value)||Array.isArray(value)?filterAllEmpty(value):!0});for(var result={},_i=0,_keys=Object.keys(object);_i<_keys.length;_i++){var k=_keys[_i],value$jscomp$0=object[k];result[k]=isPlainObject.isPlainObject(value$jscomp$0)||Array.isArray(value$jscomp$0)?filterAllEmpty(value$jscomp$0):
object[k]}return result}function hasMessages(errors){return isObject.isObject(errors)&&!isEmpty.isEmpty(errors)}function getMessages(stateMessages,actionMessages){return isEmpty.isEmpty(actionMessages)?isEmpty.isEmpty(stateMessages)?stateMessages:{}:actionMessages}function reducer(state,action){switch(action.type){case "reset":return _rollupPluginBabelHelpers._objectSpread2(_rollupPluginBabelHelpers._objectSpread2({},state),{},{values:state.initialValues,touched:{},errors:{},messages:{},valid:!0,
validating:!1,submitting:!1,submitFailed:0,submitSucceed:0});case "startValidate":return _rollupPluginBabelHelpers._objectSpread2(_rollupPluginBabelHelpers._objectSpread2({},state),{},{validating:!0});case "endValidate":return _rollupPluginBabelHelpers._objectSpread2(_rollupPluginBabelHelpers._objectSpread2({},state),{},{validating:!1,errors:getMessages(state.errors,action.errors),messages:getMessages(state.messages,action.messages),valid:!hasMessages(action.errors)});case "startSubmit":return _rollupPluginBabelHelpers._objectSpread2(_rollupPluginBabelHelpers._objectSpread2({},
state),{},{touched:Form_utils_setAllIn.unstable_setAllIn(state.values,!0),submitting:!0});case "endSubmit":var valid=!hasMessages(action.errors);return _rollupPluginBabelHelpers._objectSpread2(_rollupPluginBabelHelpers._objectSpread2({},state),{},{valid,submitting:!1,errors:getMessages(state.errors,action.errors),messages:getMessages(state.messages,action.messages),submitSucceed:valid?state.submitSucceed+1:state.submitSucceed,submitFailed:valid?state.submitFailed:state.submitFailed+1});case "update":return valid=
action.name,action=action.value,action="function"===typeof action?action(Form_utils_getIn.unstable_getIn(state.values,valid)):action,_rollupPluginBabelHelpers._objectSpread2(_rollupPluginBabelHelpers._objectSpread2({},state),{},{values:Form_utils_setIn.unstable_setIn(state.values,valid,null!=action?action:"")});case "blur":return _rollupPluginBabelHelpers._objectSpread2(_rollupPluginBabelHelpers._objectSpread2({},state),{},{touched:Form_utils_setIn.unstable_setIn(state.touched,action.name,!0)});case "push":return valid=
Form_utils_getIn.unstable_getIn(state.values,action.name,[]),_rollupPluginBabelHelpers._objectSpread2(_rollupPluginBabelHelpers._objectSpread2({},state),{},{values:Form_utils_setIn.unstable_setIn(state.values,action.name,[].concat(valid,[action.value]))});case "remove":return valid=Form_utils_getIn.unstable_getIn(state.values,action.name,[]).slice(),delete valid[action.index],_rollupPluginBabelHelpers._objectSpread2(_rollupPluginBabelHelpers._objectSpread2({},state),{},{values:Form_utils_setIn.unstable_setIn(state.values,
action.name,valid)});default:throw Error();}}Object.defineProperty(exports,"__esModule",{value:!0});var _rollupPluginBabelHelpers=require("module$node_modules$reakit$lib$_rollupPluginBabelHelpers_8f9a8751"),React=require("module$node_modules$react$index"),useLiveRef=require("module$node_modules$reakit_utils$lib$useLiveRef"),useSealedState=require("module$node_modules$reakit_utils$lib$useSealedState"),useUpdateEffect=require("module$node_modules$reakit_utils$lib$useUpdateEffect");require("module$node_modules$reakit$lib$Id$IdProvider");
var Id_IdState=require("module$node_modules$reakit$lib$Id$IdState"),isEmpty=require("module$node_modules$reakit_utils$lib$isEmpty"),Form_utils_getIn=require("module$node_modules$reakit$lib$Form$utils$getIn"),isPromise=require("module$node_modules$reakit_utils$lib$isPromise"),isPlainObject=require("module$node_modules$reakit_utils$lib$isPlainObject"),isObject=require("module$node_modules$reakit_utils$lib$isObject"),Form_utils_setAllIn=require("module$node_modules$reakit$lib$Form$utils$setAllIn");require("module$node_modules$reakit_utils$lib$toArray");
require("module$node_modules$reakit_utils$lib$isInteger");var Form_utils_setIn=require("module$node_modules$reakit$lib$Form$utils$setIn");exports.unstable_useFormState=function(initialState){void 0===initialState&&(initialState={});var _useSealedState=useSealedState.useSealedState(initialState),_useSealedState$value=_useSealedState.values;_useSealedState$value=void 0===_useSealedState$value?{}:_useSealedState$value;var _useSealedState$valid=_useSealedState.validateOnBlur,validateOnBlur=void 0===_useSealedState$valid?
!0:_useSealedState$valid;_useSealedState$valid=_useSealedState.validateOnChange;var validateOnChange=void 0===_useSealedState$valid?!0:_useSealedState$valid;_useSealedState$valid=_useSealedState.resetOnSubmitSucceed;var resetOnSubmitSucceed=void 0===_useSealedState$valid?!1:_useSealedState$valid;_useSealedState$valid=_useSealedState.resetOnUnmount;var resetOnUnmount=void 0===_useSealedState$valid?!0:_useSealedState$valid;_useSealedState$valid=_useSealedState.onValidate;var onSubmit=_useSealedState.onSubmit;
_useSealedState=_rollupPluginBabelHelpers._objectWithoutPropertiesLoose(_useSealedState,"values validateOnBlur validateOnChange resetOnSubmitSucceed resetOnUnmount onValidate onSubmit".split(" "));var onValidateRef=useLiveRef.useLiveRef("function"!==typeof initialState?initialState.onValidate:_useSealedState$valid),onSubmitRef=useLiveRef.useLiveRef("function"!==typeof initialState?initialState.onSubmit:onSubmit);initialState=Id_IdState.unstable_useIdState(_useSealedState);_useSealedState$value=React.useReducer(reducer,
{initialValues:_useSealedState$value,values:_useSealedState$value,touched:{},errors:{},messages:{},valid:!0,validating:!1,submitting:!1,submitFailed:0,submitSucceed:0});var state=_rollupPluginBabelHelpers._objectWithoutPropertiesLoose(_useSealedState$value[0],["initialValues"]),dispatch=_useSealedState$value[1],validate=React.useCallback(function(vals){void 0===vals&&(vals=state.values);return(new Promise(function(resolve){if(onValidateRef.current){var response=onValidateRef.current(vals);isPromise.isPromise(response)&&
dispatch({type:"startValidate"});resolve(Promise.resolve(response).then(function(messages){dispatch({type:"endValidate",messages});return messages}))}else resolve(void 0)})).catch(function(errors){dispatch({type:"endValidate",errors});throw errors;})},[state.values]);useUpdateEffect.useUpdateEffect(function(){validateOnChange&&validate().catch(function(){})},[validate,validateOnChange]);React.useEffect(function(){if(resetOnUnmount)return function(){dispatch({type:"reset"})}},[resetOnUnmount]);return _rollupPluginBabelHelpers._objectSpread2(_rollupPluginBabelHelpers._objectSpread2(_rollupPluginBabelHelpers._objectSpread2({},
initialState),state),{},{values:state.values,validate,reset:React.useCallback(function(){return dispatch({type:"reset"})},[]),submit:React.useCallback(function(){dispatch({type:"startSubmit"});return validate().then(function(validateMessages){return onSubmitRef.current?Promise.resolve(onSubmitRef.current(filterAllEmpty(state.values))).then(function(submitMessages){submitMessages=_rollupPluginBabelHelpers._objectSpread2(_rollupPluginBabelHelpers._objectSpread2({},validateMessages),submitMessages);
dispatch({type:"endSubmit",messages:submitMessages})}):dispatch({type:"endSubmit",messages:validateMessages})}).then(function(){resetOnSubmitSucceed&&dispatch({type:"reset"})}).catch(function(errors){dispatch({type:"endSubmit",errors})})},[validate]),update:React.useCallback(function(name,value){return dispatch({type:"update",name,value})},[]),blur:React.useCallback(function(name){dispatch({type:"blur",name});validateOnBlur&&validate().catch(function(){})},[validate]),push:React.useCallback(function(name,
value){return dispatch({type:"push",name,value})},[]),remove:React.useCallback(function(name,index){return dispatch({type:"remove",name,index})},[])})}}
//# sourceMappingURL=module$node_modules$reakit$lib$Form$FormState.js.map
