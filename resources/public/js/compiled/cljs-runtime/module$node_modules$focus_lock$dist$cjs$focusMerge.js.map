{
"version":3,
"file":"module$node_modules$focus_lock$dist$cjs$focusMerge.js",
"lineCount":9,
"mappings":"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",
"sources":["node_modules/focus-lock/dist/cjs/focusMerge.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$focus_lock$dist$cjs$focusMerge\"] = function(global,require,module,exports) {\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getFocusabledIn = exports.newFocus = undefined;\n\nvar _DOMutils = require('./utils/DOMutils');\n\nvar _firstFocus = require('./utils/firstFocus');\n\nvar _firstFocus2 = _interopRequireDefault(_firstFocus);\n\nvar _allAffected = require('./utils/all-affected');\n\nvar _allAffected2 = _interopRequireDefault(_allAffected);\n\nvar _array = require('./utils/array');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar findAutoFocused = function findAutoFocused(autoFocusables) {\n  return function (node) {\n    return !!node.autofocus || node.dataset && !!node.dataset.autofocus || autoFocusables.indexOf(node) >= 0;\n  };\n};\n\nvar isGuard = function isGuard(node) {\n  return node && node.dataset && node.dataset.focusGuard;\n};\nvar notAGuard = function notAGuard(node) {\n  return !isGuard(node);\n};\n\nvar newFocus = exports.newFocus = function newFocus(innerNodes, outerNodes, activeElement, lastNode, autoFocused) {\n  var cnt = innerNodes.length;\n  var firstFocus = innerNodes[0];\n  var lastFocus = innerNodes[cnt - 1];\n  var isOnGuard = isGuard(activeElement);\n\n  // focus is inside\n  if (innerNodes.indexOf(activeElement) >= 0) {\n    return undefined;\n  }\n\n  var activeIndex = outerNodes.indexOf(activeElement);\n  var lastIndex = outerNodes.indexOf(lastNode || activeIndex);\n  var lastNodeInside = innerNodes.indexOf(lastNode);\n  var indexDiff = activeIndex - lastIndex;\n  var firstNodeIndex = outerNodes.indexOf(firstFocus);\n  var lastNodeIndex = outerNodes.indexOf(lastFocus);\n\n  var returnFirstNode = (0, _firstFocus.pickFocusable)(innerNodes, 0);\n  var returnLastNode = (0, _firstFocus.pickFocusable)(innerNodes, cnt - 1);\n\n  // new focus\n  if (activeIndex === -1 || lastNodeInside === -1) {\n    return innerNodes.indexOf(autoFocused && autoFocused.length ? (0, _firstFocus2.default)(autoFocused) : (0, _firstFocus2.default)(innerNodes));\n  }\n  // old focus\n  if (!indexDiff && lastNodeInside >= 0) {\n    return lastNodeInside;\n  }\n  // first element\n  if (activeIndex <= firstNodeIndex && isOnGuard && Math.abs(indexDiff) > 1) {\n    return returnLastNode;\n  }\n  // last element\n  if (activeIndex >= firstNodeIndex && isOnGuard && Math.abs(indexDiff) > 1) {\n    return returnFirstNode;\n  }\n  // jump out, but not on the guard\n  if (indexDiff && Math.abs(indexDiff) > 1) {\n    return lastNodeInside;\n  }\n  // focus above lock\n  if (activeIndex <= firstNodeIndex) {\n    return returnLastNode;\n  }\n  // focus below lock\n  if (activeIndex > lastNodeIndex) {\n    return returnFirstNode;\n  }\n  // index is inside tab order, but outside Lock\n  if (indexDiff) {\n    if (Math.abs(indexDiff) > 1) {\n      return lastNodeInside;\n    }\n    return (cnt + lastNodeInside + indexDiff) % cnt;\n  }\n  // do nothing\n  return undefined;\n};\n\nvar getTopCommonParent = function getTopCommonParent(baseActiveElement, leftEntry, rightEntries) {\n  var activeElements = (0, _array.asArray)(baseActiveElement);\n  var leftEntries = (0, _array.asArray)(leftEntry);\n  var activeElement = activeElements[0];\n  var topCommon = null;\n  leftEntries.filter(Boolean).forEach(function (entry) {\n    topCommon = (0, _DOMutils.getCommonParent)(topCommon || entry, entry) || topCommon;\n    rightEntries.filter(Boolean).forEach(function (subEntry) {\n      var common = (0, _DOMutils.getCommonParent)(activeElement, subEntry);\n      if (common) {\n        if (!topCommon || common.contains(topCommon)) {\n          topCommon = common;\n        } else {\n          topCommon = (0, _DOMutils.getCommonParent)(common, topCommon);\n        }\n      }\n    });\n  });\n  return topCommon;\n};\n\nvar allParentAutofocusables = function allParentAutofocusables(entries) {\n  return entries.reduce(function (acc, node) {\n    return acc.concat((0, _DOMutils.parentAutofocusables)(node));\n  }, []);\n};\n\nvar reorderNodes = function reorderNodes(srcNodes, dstNodes) {\n  var remap = new Map();\n  // no Set(dstNodes) for IE11 :(\n  dstNodes.forEach(function (entity) {\n    return remap.set(entity.node, entity);\n  });\n  // remap to dstNodes\n  return srcNodes.map(function (node) {\n    return remap.get(node);\n  }).filter(Boolean);\n};\n\nvar getFocusabledIn = exports.getFocusabledIn = function getFocusabledIn(topNode) {\n  var entries = (0, _allAffected2.default)(topNode).filter(notAGuard);\n  var commonParent = getTopCommonParent(topNode, topNode, entries);\n  var outerNodes = (0, _DOMutils.getTabbableNodes)([commonParent], true);\n  var innerElements = (0, _DOMutils.getTabbableNodes)(entries).filter(function (_ref) {\n    var node = _ref.node;\n    return notAGuard(node);\n  }).map(function (_ref2) {\n    var node = _ref2.node;\n    return node;\n  });\n\n  return outerNodes.map(function (_ref3) {\n    var node = _ref3.node,\n        index = _ref3.index;\n    return {\n      node: node,\n      index: index,\n      lockItem: innerElements.indexOf(node) >= 0,\n      guard: isGuard(node)\n    };\n  });\n};\n\nvar getFocusMerge = function getFocusMerge(topNode, lastNode) {\n  var activeElement = document && document.activeElement;\n  var entries = (0, _allAffected2.default)(topNode).filter(notAGuard);\n\n  var commonParent = getTopCommonParent(activeElement || topNode, topNode, entries);\n\n  var innerElements = (0, _DOMutils.getTabbableNodes)(entries).filter(function (_ref4) {\n    var node = _ref4.node;\n    return notAGuard(node);\n  });\n\n  if (!innerElements[0]) {\n    innerElements = (0, _DOMutils.getAllTabbableNodes)(entries).filter(function (_ref5) {\n      var node = _ref5.node;\n      return notAGuard(node);\n    });\n    if (!innerElements[0]) {\n      return undefined;\n    }\n  }\n\n  var outerNodes = (0, _DOMutils.getTabbableNodes)([commonParent]).map(function (_ref6) {\n    var node = _ref6.node;\n    return node;\n  });\n  var orderedInnerElements = reorderNodes(outerNodes, innerElements);\n  var innerNodes = orderedInnerElements.map(function (_ref7) {\n    var node = _ref7.node;\n    return node;\n  });\n\n  var newId = newFocus(innerNodes, outerNodes, activeElement, lastNode, innerNodes.filter(findAutoFocused(allParentAutofocusables(entries))));\n\n  if (newId === undefined) {\n    return newId;\n  }\n  return orderedInnerElements[newId];\n};\n\nexports.default = getFocusMerge;\n};"],
"names":["shadow$provide","global","require","module","exports","Object","defineProperty","value","getFocusabledIn","newFocus","undefined","_DOMutils","_firstFocus","_firstFocus2","__esModule","default","_allAffected2","_allAffected","_array","findAutoFocused","autoFocusables","node","autofocus","dataset","indexOf","isGuard","focusGuard","notAGuard","exports.newFocus","innerNodes","outerNodes","activeElement","lastNode","autoFocused","cnt","length","firstFocus","lastFocus","isOnGuard","activeIndex","lastIndex","lastNodeInside","indexDiff","firstNodeIndex","lastNodeIndex","returnFirstNode","pickFocusable","returnLastNode","Math","abs","getTopCommonParent","baseActiveElement","leftEntry","rightEntries","activeElements","asArray","leftEntries","topCommon","filter","Boolean","forEach","entry","getCommonParent","subEntry","common","contains","allParentAutofocusables","entries","reduce","acc","concat","parentAutofocusables","reorderNodes","srcNodes","dstNodes","remap","Map","entity","set","map","get","exports.getFocusabledIn","topNode","commonParent","getTabbableNodes","innerElements","_ref","_ref2","_ref3","index","lockItem","guard","getFocusMerge","document","_ref4","getAllTabbableNodes","_ref5","_ref6","orderedInnerElements","_ref7","newId"]
}
