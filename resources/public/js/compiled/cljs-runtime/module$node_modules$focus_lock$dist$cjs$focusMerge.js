shadow$provide.module$node_modules$focus_lock$dist$cjs$focusMerge=function(global,require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0});exports.getFocusabledIn=exports.newFocus=void 0;var _DOMutils=require("module$node_modules$focus_lock$dist$cjs$utils$DOMutils"),_firstFocus=require("module$node_modules$focus_lock$dist$cjs$utils$firstFocus"),_firstFocus2=_firstFocus&&_firstFocus.__esModule?_firstFocus:{default:_firstFocus},_allAffected2=(global=require("module$node_modules$focus_lock$dist$cjs$utils$all_affected"))&&
global.__esModule?global:{default:global},_array=require("module$node_modules$focus_lock$dist$cjs$utils$array"),findAutoFocused=function(autoFocusables){return function(node){return!!node.autofocus||node.dataset&&!!node.dataset.autofocus||0<=autoFocusables.indexOf(node)}},isGuard=function(node){return node&&node.dataset&&node.dataset.focusGuard},notAGuard=function(node){return!isGuard(node)},newFocus=exports.newFocus=function(innerNodes,outerNodes,activeElement,lastNode,autoFocused){var cnt=innerNodes.length,
firstFocus=innerNodes[0],lastFocus=innerNodes[cnt-1],isOnGuard=isGuard(activeElement);if(!(0<=innerNodes.indexOf(activeElement))){activeElement=outerNodes.indexOf(activeElement);var lastIndex=outerNodes.indexOf(lastNode||activeElement);lastNode=innerNodes.indexOf(lastNode);lastIndex=activeElement-lastIndex;firstFocus=outerNodes.indexOf(firstFocus);outerNodes=outerNodes.indexOf(lastFocus);lastFocus=(0,_firstFocus.pickFocusable)(innerNodes,0);var returnLastNode=(0,_firstFocus.pickFocusable)(innerNodes,
cnt-1);if(-1===activeElement||-1===lastNode)return innerNodes.indexOf(autoFocused&&autoFocused.length?(0,_firstFocus2.default)(autoFocused):(0,_firstFocus2.default)(innerNodes));if(!lastIndex&&0<=lastNode)return lastNode;if(activeElement<=firstFocus&&isOnGuard&&1<Math.abs(lastIndex))return returnLastNode;if(activeElement>=firstFocus&&isOnGuard&&1<Math.abs(lastIndex))return lastFocus;if(lastIndex&&1<Math.abs(lastIndex))return lastNode;if(activeElement<=firstFocus)return returnLastNode;if(activeElement>
outerNodes)return lastFocus;if(lastIndex)return 1<Math.abs(lastIndex)?lastNode:(cnt+lastNode+lastIndex)%cnt}},getTopCommonParent=function(baseActiveElement,leftEntry,rightEntries){baseActiveElement=(0,_array.asArray)(baseActiveElement);leftEntry=(0,_array.asArray)(leftEntry);var activeElement=baseActiveElement[0],topCommon=null;leftEntry.filter(Boolean).forEach(function(entry){topCommon=(0,_DOMutils.getCommonParent)(topCommon||entry,entry)||topCommon;rightEntries.filter(Boolean).forEach(function(subEntry){(subEntry=
(0,_DOMutils.getCommonParent)(activeElement,subEntry))&&(topCommon=!topCommon||subEntry.contains(topCommon)?subEntry:(0,_DOMutils.getCommonParent)(subEntry,topCommon))})});return topCommon},allParentAutofocusables=function(entries){return entries.reduce(function(acc,node){return acc.concat((0,_DOMutils.parentAutofocusables)(node))},[])},reorderNodes=function(srcNodes,dstNodes){var remap=new Map;dstNodes.forEach(function(entity){return remap.set(entity.node,entity)});return srcNodes.map(function(node){return remap.get(node)}).filter(Boolean)};
exports.getFocusabledIn=function(topNode){var entries=(0,_allAffected2.default)(topNode).filter(notAGuard);topNode=getTopCommonParent(topNode,topNode,entries);topNode=(0,_DOMutils.getTabbableNodes)([topNode],!0);var innerElements=(0,_DOMutils.getTabbableNodes)(entries).filter(function(_ref){return!isGuard(_ref.node)}).map(function(_ref2){return _ref2.node});return topNode.map(function(_ref3){var node=_ref3.node;return{node,index:_ref3.index,lockItem:0<=innerElements.indexOf(node),guard:isGuard(node)}})};
exports.default=function(topNode,lastNode){var activeElement=document&&document.activeElement,entries=(0,_allAffected2.default)(topNode).filter(notAGuard);topNode=getTopCommonParent(activeElement||topNode,topNode,entries);var innerElements=(0,_DOMutils.getTabbableNodes)(entries).filter(function(_ref4){return!isGuard(_ref4.node)});if(!innerElements[0]&&(innerElements=(0,_DOMutils.getAllTabbableNodes)(entries).filter(function(_ref5){return!isGuard(_ref5.node)}),!innerElements[0]))return;topNode=(0,
_DOMutils.getTabbableNodes)([topNode]).map(function(_ref6){return _ref6.node});innerElements=reorderNodes(topNode,innerElements);var innerNodes=innerElements.map(function(_ref7){return _ref7.node});lastNode=newFocus(innerNodes,topNode,activeElement,lastNode,innerNodes.filter(findAutoFocused(allParentAutofocusables(entries))));return void 0===lastNode?lastNode:innerElements[lastNode]}}
//# sourceMappingURL=module$node_modules$focus_lock$dist$cjs$focusMerge.js.map
